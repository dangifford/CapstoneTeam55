'Jamaica',
'Switzerland',
'Nicaragua',
'Poland',
'Italy',
'Greece',
'France',
'Albania',
'Romania',
'Guinea',
'Nepal',
'Cuba',
'Philippines',
'Comoros',
'India',
'Antigua and Barbuda',
'Madagascar',
'Burkina Faso',
'Hungary',
'Botswana',
'Chile',
'Cabo Verde',
'China',
'Mauritius',
'Vietnam'),2,ifelse(new$countryname %in% c('Cyprus','Uganda',
'Australia',
'Ukraine',
'Eritrea',
'El Salvador',
'Rwanda',
'Barbados',
'Turkey',
'Denmark',
'Ethiopia',
'Lebanon',
'Nigeria',
'Tonga',
'United Kingdom',
'Morocco',
'Armenia',
'Argentina',
'Bangladesh',
'Netherlands',
'Azerbaijan',
'Ireland',
'Namibia',
'Burundi',
'Turkmenistan',
'Uruguay',
'Mongolia',
'Togo',
'South Africa',
'Uzbekistan',
'Kenya',
'Israel',
'Iran, Islamic Rep.',
'Tunisia',
'Chad',
'Mali',
'Kyrgyz Republic',
'United Arab Emirates',
'Haiti',
'Maldives',
'Tajikistan',
'Pakistan',
'Syrian Arab Republic',
'Afghanistan',
'Iraq',
'Lesotho',
'Kazakhstan',
'Jordan',
'Yemen, Rep.',
'Niger',
'Algeria',
'Bahrain',
'Saudi Arabia',
'Kuwait',
'Mauritania',
'Libya',
'Oman',
'Qatar'),3,4)))
new$gdpgroup <- ifelse(new$countryname %in% c('United States',
'Japan',
'Germany',
'United Kingdom',
'France',
'China',
'Italy',
'Spain',
'Canada',
'Brazil',
'Mexico',
'Korea, Rep.',
'India',
'Netherlands',
'Russian Federation',
'Australia',
'Switzerland',
'Belgium',
'Sweden',
'Turkey',
'Argentina',
'Austria',
'Indonesia',
'Norway',
'Denmark',
'Poland',
'Saudi Arabia',
'Greece',
'Iran, Islamic Rep.',
'South Africa',
'Thailand',
'Finland',
'Portugal',
'Ireland',
'Iraq',
'Israel',
'United Arab Emirates',
'Venezuela, RB',
'Malaysia',
'Colombia',
'Nigeria',
'Czech Republic',
'Hungary',
'New Zealand',
'Chile',
'Philippines',
'Pakistan',
'Ukraine',
'Puerto Rico',
'Algeria',
'Bangladesh',
'Peru',
'Romania',
'Morocco',
'Kuwait',
'Slovak Republic',
'Croatia'),1,ifelse(new$countryname %in% c('Vietnam','Cuba','Libya',
'Ecuador', 'Myanmar',
'Kazakhstan',
'Slovenia', 'Lithuania',
'Tunisia',
'Dominican Republic',
'Qatar',
'Uruguay',
'Guatemala',
'Belarus',
'Oman',
'Bulgaria',
'Lebanon', 'Latvia',
'Sri Lanka', 'Angola',
'Costa Rica','Syrian Arab Republic',
'Cameroon',
"Cote d'Ivoire",
'Tanzania',
'Kenya',
'Uzbekistan',
'Cyprus',
'Panama',
'El Salvador',
'Estonia',
'Afghanistan',
'Ethiopia', 'Yemen, Rep.',
'Trinidad and Tobago','Bosnia and Herzegovina',
'Bahrain',
'Congo, Dem. Rep.',
'Jordan',
'Paraguay',
'Jamaica',
'Bahamas, The',
'Azerbaijan',
'Senegal',
'Bolivia',
'Honduras',
'Ghana',
'Botswana',
'Zimbabwe',
'Uganda',
'Brunei Darussalam',
'Georgia',
'Nepal',
'Turkmenistan',
'Mauritius','Cambodia',
'Albania',
'Nicaragua'),2,ifelse(new$countryname %in% c('Papua New Guinea','North Macedonia','Zambia','Namibia','Guam',
'Mali',
'Madagascar','Cayman Islands',
'Burkina Faso','Virgin Islands (U.S.)',
'Haiti',
'Benin',
'Guinea',
'French Polynesia',
'Congo, Rep.',
'Malawi',
'Barbados',
'New Caledonia','Timor-Leste',
'Armenia',
'Chad',
'Niger',
'Equatorial Guinea',
'Kyrgyz Republic',
'Mongolia',
'Fiji',
'Tajikistan',
'Togo',
'Rwanda',
'Lao PDR',
'Liberia',
'Mauritania',
'Sierra Leone',
'Central African Republic',
'Suriname','Lesotho','Burundi','Maldives',
'Belize',
'Northern Mariana Islands',
'St. Lucia',
'Eritrea',
'Antigua and Barbuda',
'Gambia, The',
'Cabo Verde',
'Guyana',
'Bhutan',
'Grenada',
'Comoros',
'St. Kitts and Nevis',
'Solomon Islands',
'St. Vincent and the Grenadines',
'Dominica',
'Samoa',
'Vanuatu',
'Micronesia, Fed. Sts.',
'Tonga',
'Palau'),3,4)))
new$popgroup <- ifelse(new$countryname %in% c('China',
'India',
'United States',
'Indonesia',
'Brazil',
'Pakistan',
'Russian Federation',
'Bangladesh',
'Nigeria',
'Japan',
'Mexico',
'Philippines',
'Vietnam',
'Germany',
'Ethiopia',
'Iran, Islamic Rep.',
'Turkey',
'Thailand',
'France',
'United Kingdom',
'Italy',
'Congo, Dem. Rep.',
'Myanmar',
'Korea, Rep.',
'Ukraine',
'South Africa',
'Spain',
'Colombia',
'Poland',
'Argentina',
'Tanzania',
'Kenya',
'Algeria',
'Canada',
'Morocco',
'Peru',
'Uganda',
'Iraq',
'Uzbekistan',
'Venezuela, RB',
'Nepal',
'Malaysia',
'Afghanistan',
'Saudi Arabia',
'Romania',
'Ghana',
'Australia',
'Sri Lanka',
'Yemen, Rep.',
'Angola',
"Cote d'Ivoire",
'Syrian Arab Republic',
'Madagascar',
'Cameroon',
'Netherlands',
'Chile',
'Kazakhstan'),1,ifelse(new$countryname %in% c('Ecuador','Cambodia',
'Burkina Faso',
'Niger',
'Guatemala',
'Malawi',
'Mali',
'Zimbabwe',
'Zambia',
'Cuba',
'Greece',
'Belgium',
'Senegal',
'Portugal',
'Czech Republic',
'Hungary',
'Tunisia',
'Belarus',
'Chad',
'Sweden',
'Bolivia',
'Haiti',
'Dominican Republic',
'Guinea',
'Rwanda',
'Azerbaijan',
'Austria',
'Bulgaria',
'Benin',
'Switzerland',
'Honduras',
'Burundi',
'Israel',
'Tajikistan',
'Papua New Guinea',
'El Salvador',
'Paraguay',
'Libya',
'Lao PDR',
'Jordan',
'Denmark',
'Slovak Republic',
'Togo',
'Nicaragua',
'Finland',
'Sierra Leone',
'Kyrgyz Republic',
'Turkmenistan',
'Norway',
'Lebanon',
'Croatia',
'Costa Rica',
'New Zealand',
'Ireland',
'Georgia',
'Central African Republic',
'Bosnia and Herzegovina',
'Puerto Rico'),2,ifelse(new$countryname %in% c('United Arab Emirates','Lithuania',
'Congo, Rep.',
'Uruguay',
'Panama',
'Liberia',
'Albania',
'Armenia',
'Mauritania',
'Jamaica',
'Eritrea',
'Mongolia',
'Oman',
'Latvia',
'Kuwait',
'North Macedonia',
'Slovenia',
'Lesotho',
'Namibia',
'Botswana',
'Gambia, The',
'Estonia',
'Trinidad and Tobago',
'Mauritius',
'Cyprus',
'Timor-Leste',
'Fiji',
'Bahrain',
'Guyana',
'Equatorial Guinea',
'Qatar',
'Bhutan',
'Comoros',
'Suriname',
'Cabo Verde',
'Solomon Islands',
'Brunei Darussalam',
'Bahamas, The',
'Maldives',
'Barbados',
'Belize',
'French Polynesia',
'New Caledonia',
'Vanuatu',
'Samoa',
'St. Lucia',
'Guam',
'Virgin Islands (U.S.)',
'St. Vincent and the Grenadines',
'Micronesia, Fed. Sts.',
'Grenada',
'Tonga',
'Antigua and Barbuda',
'Dominica',
'Northern Mariana Islands',
'Cayman Islands',
'St. Kitts and Nevis',
'Palau'),3,4)))
output <- merge(new,char,by=c("countryname","yr"))
oth <- c("x_6646_5110","x_6646_72151","IncomeGroup.y","yrc.x.1","Year.y.1","Sub.Regions.y","Commodity.driven.deforestation.y","Forestry.y","Wildfire.y","Shifting.agriculture.y")
output2 <- output[ ,!(names(output) %in% oth)]
write.csv(output2,"./Data/country_pred_data_v2.csv")
updated <- read.csv("./Data/country_pred_data_v2.csv")
#build our delta dataset
forlag <- updated[ ,names(updated) %in% c("Country.Code","yr","forest_area","gdp","pop",'x_257_5910',
'x_236_5910',
'x_2071_5910',
'x_258_5910',
'x_237_5910',
'x_1601_5516',
'x_1604_5516',
'x_1623_5516',
'x_1626_5516',
'x_1633_5516',
'x_1602_5516',
'x_1603_5516',
'x_1634_5516',
'x_6798_7246',
'x_6798_7245',
'x_6610_5110',
'x_6716_5110',
'x_6717_5110')]
forlag2 <- subset(forlag,yr<2016)
forlag2$yr <- forlag2$yr+1
colnames(forlag2)[2] <- "lag_gdp"
colnames(forlag2)[3] <- "lag_pop"
colnames(forlag2)[4] <- "lag_forest_area"
colnames(forlag2)[13] <- 'lag_x_257_5910'
colnames(forlag2)[11] <- 'lag_x_236_5910'
colnames(forlag2)[10] <- 'lag_x_2071_5910'
colnames(forlag2)[14] <- 'lag_x_258_5910'
colnames(forlag2)[12] <- 'lag_x_237_5910'
colnames(forlag2)[15] <- 'lag_x_1601_5516'
colnames(forlag2)[18] <- 'lag_x_1604_5516'
colnames(forlag2)[19] <- 'lag_x_1623_5516'
colnames(forlag2)[20] <- 'lag_x_1626_5516'
colnames(forlag2)[21] <- 'lag_x_1633_5516'
colnames(forlag2)[16] <- 'lag_x_1602_5516'
colnames(forlag2)[17] <- 'lag_x_1603_5516'
colnames(forlag2)[22] <- 'lag_x_1634_5516'
colnames(forlag2)[6] <- 'lag_x_6798_7246'
colnames(forlag2)[5] <- 'lag_x_6798_7245'
colnames(forlag2)[7] <- 'lag_x_6610_5110'
colnames(forlag2)[8] <- 'lag_x_6716_5110'
colnames(forlag2)[9] <- 'lag_x_6717_5110'
output3 <- merge(updated,forlag2,by=c("Country.Code","yr"))
output3$delta_gdp<-ifelse(output3$lag_gdp==0 | is.na(output3$lag_gdp),0,(output3$gdp-output3$lag_gdp)/output3$lag_gdp)
output3$delta_forest_area<-ifelse(output3$lag_forest_area==0 | is.na(output3$lag_forest_area),0,(output3$forest_area-output3$lag_forest_area)/output3$lag_forest_area)
output3$delta_pop<-ifelse(output3$lag_pop==0 | is.na(output3$lag_pop),0,(output3$pop-output3$lag_pop)/output3$lag_pop)
output3$delta_x_257_5910<-ifelse(output3$lag_x_257_5910==0 | is.na(output3$lag_x_257_5910),0,(output3$x_257_5910-output3$lag_x_257_5910)/output3$lag_x_257_5910)
output3$delta_x_236_5910<-ifelse(output3$lag_x_236_5910==0 | is.na(output3$lag_x_236_5910),0,(output3$x_236_5910-output3$lag_x_236_5910)/output3$lag_x_236_5910)
output3$delta_x_2071_5910<-ifelse(output3$lag_x_2071_5910==0 | is.na(output3$lag_x_2071_5910),0,(output3$x_2071_5910-output3$lag_x_2071_5910)/output3$lag_x_2071_5910)
output3$delta_x_258_5910<-ifelse(output3$lag_x_258_5910==0 | is.na(output3$lag_x_258_5910),0,(output3$x_258_5910-output3$lag_x_258_5910)/output3$lag_x_258_5910)
output3$delta_x_237_5910<-ifelse(output3$lag_x_237_5910==0 | is.na(output3$lag_x_237_5910),0,(output3$x_237_5910-output3$lag_x_237_5910)/output3$lag_x_237_5910)
output3$delta_x_1601_5516<-ifelse(output3$lag_x_1601_5516==0 | is.na(output3$lag_x_1601_5516),0,(output3$x_1601_5516-output3$lag_x_1601_5516)/output3$lag_x_1601_5516)
output3$delta_x_1604_5516<-ifelse(output3$lag_x_1604_5516==0 | is.na(output3$lag_x_1604_5516),0,(output3$x_1604_5516-output3$lag_x_1604_5516)/output3$lag_x_1604_5516)
output3$delta_x_1623_5516<-ifelse(output3$lag_x_1623_5516==0 | is.na(output3$lag_x_1623_5516),0,(output3$x_1623_5516-output3$lag_x_1623_5516)/output3$lag_x_1623_5516)
output3$delta_x_1626_5516<-ifelse(output3$lag_x_1626_5516==0 | is.na(output3$lag_x_1626_5516),0,(output3$x_1626_5516-output3$lag_x_1626_5516)/output3$lag_x_1626_5516)
output3$delta_x_1633_5516<-ifelse(output3$lag_x_1633_5516==0 | is.na(output3$lag_x_1633_5516),0,(output3$x_1633_5516-output3$lag_x_1633_5516)/output3$lag_x_1633_5516)
output3$delta_x_1602_5516<-ifelse(output3$lag_x_1602_5516==0 | is.na(output3$lag_x_1602_5516),0,(output3$x_1602_5516-output3$lag_x_1602_5516)/output3$lag_x_1602_5516)
output3$delta_x_1603_5516<-ifelse(output3$lag_x_1603_5516==0 | is.na(output3$lag_x_1603_5516),0,(output3$x_1603_5516-output3$lag_x_1603_5516)/output3$lag_x_1603_5516)
output3$delta_x_1634_5516<-ifelse(output3$lag_x_1634_5516==0 | is.na(output3$lag_x_1634_5516),0,(output3$x_1634_5516-output3$lag_x_1634_5516)/output3$lag_x_1634_5516)
output3$delta_x_6798_7246<-ifelse(output3$lag_x_6798_7246==0 | is.na(output3$lag_x_6798_7246),0,(output3$x_6798_7246-output3$lag_x_6798_7246)/output3$lag_x_6798_7246)
output3$delta_x_6798_7245<-ifelse(output3$lag_x_6798_7245==0 | is.na(output3$lag_x_6798_7245),0,(output3$x_6798_7245-output3$lag_x_6798_7245)/output3$lag_x_6798_7245)
output3$delta_x_6610_5110<-ifelse(output3$lag_x_6610_5110==0 | is.na(output3$lag_x_6610_5110),0,(output3$x_6610_5110-output3$lag_x_6610_5110)/output3$lag_x_6610_5110)
output3$delta_x_6716_5110<-ifelse(output3$lag_x_6716_5110==0 | is.na(output3$lag_x_6716_5110),0,(output3$x_6716_5110-output3$lag_x_6716_5110)/output3$lag_x_6716_5110)
output3$delta_x_6717_5110<-ifelse(output3$lag_x_6717_5110==0 | is.na(output3$lag_x_6717_5110),0,(output3$x_6717_5110-output3$lag_x_6717_5110)/output3$lag_x_6717_5110)
#output this data
write.csv(output3,"./Data/country_pred_delta_forest.csv")
setwd("~/Documents/MSDS498/CapstoneTeam55")
#read in the data
df <- read.csv("./Data/country_pred_data.csv")
#subset to 2016;
df16 <- subset(df, yr==2016)
par(mfrow=c(1,2))
#forest area
p <- ggplot(df16, aes(x=forest_area)) +
geom_histogram(binwidth = 500000, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Histogram of 2016 Forest Area") +
theme_light() +
theme (plot.title = element_text(size=15))
p
#pct forest
p <- ggplot(df16, aes(x=pct_forest)) +
geom_histogram(binwidth = 10, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Histogram of 2016 Percent Forest") +
theme_light() +
theme (plot.title = element_text(size=15))
p
#delta forest
df <- read.csv("./Data/country_pred_delta_forest.csv")
dfd16 <- subset(df,yr==2016)
p <- ggplot(dfd16, aes(x=delta_forest_area)) +
geom_histogram(binwidth = 0.01, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
ggtitle("Histogram of 2015-16 Change in Forest Area") +
theme_light() +
theme (plot.title = element_text(size=15))
p
#boxplots for categorical data
ggplot(df, aes(x=IncomeGroup.x, y=delta_forest_area))  +
geom_boxplot(fill="#69b3a2",  alpha=0.9) +
ggtitle("Boxplot of Change in Forest Area by Income Group") +
theme_light() +
theme (plot.title = element_text(size=15))
ggplot(df, aes(x=Sub.Regions.x, y=delta_forest_area))  +
geom_boxplot(fill="#69b3a2",  alpha=0.9) +
ggtitle("Boxplot of Change in Forest Area by Sub-Region") +
theme_light() +
theme (plot.title = element_text(size=15), axis.text.x = element_text(angle = 60, hjust = 1))
